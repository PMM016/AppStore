{% extends "base.html" %}
{% load static %}

{% block title %}
{{ app.name }} | App Details
{% endblock %}

{% block extra_css %}
  {% if app.icon %}
    <link rel="icon" href="{{ app.icon.url }}">
  {% elif app.icon_url %}
    <link rel="icon" href="{{ app.icon_url }}">
  {% endif %}  
  <link rel="stylesheet" href="{% static 'apps/app-detail.css' %}">
  <link rel="stylesheet" href="{% static 'css/nohead.css' %}">
{% endblock %}

{% block content %}

<div class="nav-crumb">
  <a class="btn btn-outline-secondary outlined" href="{% url 'back' %}">
    <i class="fa fa-chevron-left"></i> <span>Go Back</span> 
  </a>
</div>

<div class="row mb-3 py-3 app-title">
  <div class="col-md-1 col-0"></div>
  <!-- App Icon -->
  <div class="col-md-2 text-center col-12 justify-content-center">
    {% if app.icon %}
    <img src="{{ app.icon.url }}" class="app-icon" loading="lazy" style="max-height: 180px;"/>
    {% elif app.icon_url %}
      <img src="{{ app.icon_url }}" class="app-icon" loading="lazy" style="max-height: 180px;" />
    {% endif %}
  </div>

  <!-- App Info -->
  <div class="col-md-8 col-12 cent-padd">
    <h2 class="fw-bold">{{ app.name }}</h2>
    <div class="categories d-flex gap-2" tabindex="1">
      {% for category in app.categories.all %}
        <a href="{% url 'apps:category_detail' category.slug %}" class="badge d-flex align-items-center p-1 pe-2 text-success-emphasis bg-success-subtle border border-success-subtle rounded-pill">
          {% if category.icon %}
            <img src="{{ category.icon.url }}" class="category-icon rounded-circle me-1" width="24" height="24" loading="lazy" /> {{ category.name }}
          {% elif category.icon_url %}
            <img src="{{ category.icon_url }}" class="category-icon rounded-circle me-1" width="24" height="24" loading="lazy" /> {{ category.name }}
          {% elif category.icon_font %}
            <i class="{{ category.icon_font}} rounded-circle me-1"></i> {{ category.name }}
          {% else %}
            {{ category.name }}
          {% endif %}
        </a>
      {% endfor %}
    </div>
    <div class="d-flex gap-4 pt-3 size-2">
      <span class="status status-{{ app.status }}">{{ app.get_status_display }}</span>
      <span><i class="fas fa-dollar-sign me-1"></i> {{ app.cost_usd }}</span>
    </div>

    <strong class="sub-folder">
      <div class="breadcrumb mt-3">
        <i class="fas fa-folder me-1"></i> Apps
        {% if app.sub_folder %}
          / {{ app.sub_folder.folder.title }}
          / {{ app.sub_folder.title }}
        {% elif app.folders.exists %}
          / {{ app.folders.first.title }}
        {% else %}
          / Other
        {% endif %}
      </div>
    </strong>

  </div>
</div>
<div class="row my-4 app-body">
  <div class="container px-3">
    <div class="row px-5">
        <h4 class="app-use text-center">{{ app.use }}</h4>
        <div class="app-description my-3">
          {{ app.description|safe }}
        </div>
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div><strong>Crated at:</strong> {{ app.created_at }}</div>
          <div><strong>Updated last:</strong> {{ app.updated_at }}</div>
        </div>
        <div class="d-flex justify-content-center px-3 align-items-center gap-5">
          <a class="btn btn-outline-info btn-sweep" hx-get="{% url 'apps:edit' app.id %}" hx-target="#modal-content" hx-trigger="click" data-bs-toggle="modal" data-bs-target="#modal"> <i class="fas fa-edit"></i> Edit App</a>
          <a class="btn btn-outline-danger btn-sweep" href="{% url 'apps:delete' app.id %}"> <i class="fas fa-trash"></i> Delete App</a>
        </div>
    </div>
    <div class="row p-3 my-3 pag-bottom">
      <div class="d-flex">
        {% if app.previous_id %}
        <a href="{% url 'apps:view' app.previous_id %}">
          <i class="fas fa-chevron-left"></i>
          <span>Prevoius</span>
        </a>
        {% else %}
          <span>This is the first</span>
        {% endif %}
      </div>
      <div class="d-flex">
        {% if app.next_id %}
        <a href="{% url 'apps:view' app.next_id %}">
          <span>Next</span>
          <i class="fas fa-chevron-right"></i>
        </a>
        {% else %}
          <span>This is the last</span>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock %}
